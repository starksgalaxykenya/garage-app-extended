<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garage Manager PRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    
    <style>
        /* Custom scrollbar for better look */
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #a0a0a0;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Style for the printable job card (modal visibility) */
        @media print {
            body * {
                visibility: hidden;
            }
            #jobCardModal, #jobCardModal * {
                visibility: visible;
            }
            #jobCardModal {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
        }
        /* Style for the checklist tables */
        .service-table th {
            text-align: left;
            padding: 8px 12px;
            background-color: #eef2ff;
        }
        .service-table td {
            padding: 8px 12px;
            border-bottom: 1px solid #e5e7eb;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">

    <header class="bg-blue-800 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold text-white">Garage Manager PRO</h1>
                <p class="text-sm text-blue-200">The Ultimate Auto Service Tool</p>
            </div>
            <nav class="flex space-x-4">
                <button id="nav-car-entry" class="text-white hover:text-blue-200 font-medium transition duration-150">New Car Entry</button>
                <button id="nav-general-service" class="text-white hover:text-blue-200 font-medium transition duration-150">General Service</button>
                <button id="nav-clients-list" class="text-white hover:text-blue-200 font-medium transition duration-150">All Clients</button>
                <button id="nav-car-list" class="text-white hover:text-blue-200 font-medium transition duration-150">Active Jobs</button>
                <button id="nav-completed-list" class="text-white hover:text-blue-200 font-medium transition duration-150">Completed Jobs</button>
                <button id="nav-reports-section" class="text-white hover:text-blue-200 font-bold py-2 px-4 rounded-lg bg-yellow-600 hover:bg-yellow-700 transition duration-150">Reports</button>
                <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition duration-150" style="display:none;">Logout</button>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <section id="auth-section" class="flex justify-center items-center py-16" style="display:none;">
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md">
                <h2 class="text-2xl font-bold mb-6 text-center text-blue-800">Welcome to Garage Manager PRO</h2>
                <input id="auth-email" type="email" placeholder="Email" class="w-full p-3 mb-4 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" />
                <input id="auth-password" type="password" placeholder="Password" class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500" />
                <button id="loginBtn" onclick="handleLoginSignup(true)" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition duration-150 mb-3">Login</button>
                <button id="signupBtn" onclick="handleLoginSignup(false)" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 rounded-lg transition duration-150">Sign Up (Admin Only)</button>
                <p id="auth-message" class="text-red-500 text-sm mt-3 text-center"></p>
            </div>
        </section>

        <section id="car-entry" class="space-y-8" style="display:none;">
            <h2 class="text-3xl font-bold text-gray-800 border-b pb-2">üöó New Vehicle Check-in</h2>
            <form id="car-entry-form" class="space-y-6 bg-white p-6 rounded-xl shadow-lg">
                <fieldset class="border-2 border-orange-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-orange-700 px-2">Client Contact Details</legend>
                    <div class="mb-4">
                        <label for="client-search-entry" class="block text-sm font-medium text-gray-700 mb-1">Search/Select Existing Client (for autofill):</label>
                        <input id="client-search-entry" type="text" placeholder="Start typing client phone number or name..." 
                               class="w-full p-3 border rounded-lg focus:ring-purple-500 focus:border-purple-500" 
                               list="client-suggestions-list" onchange="lookupClientDetails('entry')"/>
                        <datalist id="client-suggestions-list"></datalist>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
                        <input id="client-name" type="text" placeholder="Client Full Name" required class="p-3 border rounded-lg" />
                        <input id="client-phone" type="tel" placeholder="Phone Number (e.g., +2547...)" required class="p-3 border rounded-lg" />
                        <input id="client-email" type="email" placeholder="Email (Optional)" class="p-3 border rounded-lg" />
                    </div>
                </fieldset>

                <fieldset class="border-2 border-blue-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-blue-700 px-2">Vehicle Core Details</legend>
                    <div class="mb-4">
                        <label for="car-select-entry" class="block text-sm font-medium text-gray-700 mb-1">Select Existing Vehicle (for this client):</label>
                        <select id="car-select-entry" class="w-full p-3 border rounded-lg focus:ring-purple-500 focus:border-purple-500" onchange="autofillVehicleDetails('entry')">
                            <option value="">-- New Vehicle Entry --</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
                        <input id="number-plate" type="text" placeholder="Vehicle Number Plate" required class="p-3 border rounded-lg" />
                        <input id="vin" type="text" placeholder="VIN / Chassis No." required class="p-3 border rounded-lg" />
                        <input id="make" type="text" placeholder="Make (e.g., Toyota)" required class="p-3 border rounded-lg" />
                        <input id="model" type="text" placeholder="Model (e.g., Corolla)" required class="p-3 border rounded-lg" />
                        <input id="year" type="number" placeholder="Year of Manuf." required class="p-3 border rounded-lg" />
                        <input id="color" type="text" placeholder="Color" class="p-3 border rounded-lg" />
                        <input id="engine-cc" type="text" placeholder="Engine CC (e.g., 1800)" class="p-3 border rounded-lg" />
                        <input id="trim" type="text" placeholder="Trim (e.g., SE)" class="p-3 border rounded-lg" />
                        <input id="engine-name" type="text" placeholder="Engine Name (e.g., 2ZR-FE)" class="p-3 border rounded-lg" />
                        
                        <div>
                            <label for="transmission" class="block text-sm font-medium text-gray-700 mb-1">Transmission Type</label>
                            <select id="transmission" class="w-full p-3 border rounded-lg">
                                <option value="Automatic">Automatic</option>
                                <option value="Manual">Manual</option>
                                <option value="AutoManualClutch">Auto Manual (with clutch)</option>
                                <option value="AutoManualNoClutch">Auto Manual (without clutch)</option>
                            </select>
                        </div>
                        <div>
                            <label for="drive" class="block text-sm font-medium text-gray-700 mb-1">Drive Type</label>
                            <select id="drive" class="w-full p-3 border rounded-lg">
                                <option value="FWD">Front Wheel Drive</option>
                                <option value="RWD">Rear Wheel Drive</option>
                                <option value="4WD">Four Wheel Drive (4x4)</option>
                                <option value="AWD">All Wheel Drive</option>
                            </select>
                        </div>
                    </div>
                </fieldset>

                <fieldset class="border-2 border-green-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-green-700 px-2">Service and Job Details</legend>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <textarea id="reported-problems" rows="3" placeholder="Client Reported Problems" required class="p-3 border rounded-lg"></textarea>
                        <textarea id="diagnostic-notes" rows="3" placeholder="Mechanic's Diagnostic Notes" class="p-3 border rounded-lg"></textarea>
                        
                        <div>
                            <label for="assigned-mechanic" class="block text-sm font-medium text-gray-700 mb-1">Assigned Mechanic</label>
                            <input id="assigned-mechanic" type="text" placeholder="Type Mechanic's Name" required class="w-full p-3 border rounded-lg" list="mechanic-suggestions"/>
                            <datalist id="mechanic-suggestions">
                                <option value="John Doe (Mock)">
                                <option value="Jane Smith (Mock)">
                            </datalist>
                        </div>

                        <div>
                            <label for="due-date" class="block text-sm font-medium text-gray-700 mb-1">Service Due Date</label>
                            <input id="due-date" type="date" class="w-full p-3 border rounded-lg" />
                        </div>
                        <div>
                            <label for="delivery-date" class="block text-sm font-medium text-gray-700 mb-1">Estimated Delivery Date</label>
                            <input id="delivery-date" type="date" class="w-full p-3 border rounded-lg" />
                        </div>
                    </div>
                </fieldset>
                
                <fieldset class="border-2 border-red-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-red-700 px-2">Error Codes & Diagnostic</legend>
                    <div id="error-codes-container" class="space-y-4">
                        </div>
                    <button type="button" onclick="addErrorCodeInput()" class="mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg transition duration-150">Add Another Error Code</button>
                </fieldset>
                
                <fieldset class="border-2 border-pink-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-pink-700 px-2">üõ†Ô∏è Repair Plan / Action Items</legend>
                    <div id="repair-plan-container" class="space-y-4 mt-4">
                        </div>
                    <button type="button" onclick="addRepairPlanCard()" class="mt-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-150">Add Repair Plan Item</button>
                </fieldset>

                <div class="flex justify-end space-x-4 pt-4">
                    <button type="button" onclick="createJobCard()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-6 rounded-lg transition duration-150">Generate Job Card</button>
                    <button type="button" onclick="generateAnalysisReportPDF()" class="bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 px-6 rounded-lg transition duration-150">Generate Analysis Report (PDF)</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-150">Save Vehicle Entry</button>
                </div>
            </form>
        </section>
        
        <section id="general-service" class="space-y-8" style="display:none;">
            <h2 class="text-3xl font-bold text-gray-800 border-b pb-2">üõ†Ô∏è Vehicle General Service Checklist</h2>
            <form id="general-service-form" onsubmit="event.preventDefault();" class="space-y-6 bg-white p-6 rounded-xl shadow-lg">
                <fieldset class="border-2 border-orange-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-orange-700 px-2">Client Contact Details</legend>
                    <div class="mb-4">
                        <label for="client-search-service" class="block text-sm font-medium text-gray-700 mb-1">Search/Select Existing Client (for autofill):</label>
                        <input id="client-search-service" type="text" placeholder="Start typing client phone number or name..." 
                               class="w-full p-3 border rounded-lg focus:ring-purple-500 focus:border-purple-500" 
                               list="client-suggestions-list" onchange="lookupClientDetails('service')"/>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <input id="service-client-name" type="text" placeholder="Client Full Name" required class="p-3 border rounded-lg" />
                        <input id="service-client-phone" type="tel" placeholder="Phone Number" required class="p-3 border rounded-lg" />
                    </div>
                </fieldset>
                <fieldset class="border-2 border-blue-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-blue-700 px-2">Vehicle ID for Service</legend>
                    <div class="mb-4">
                        <label for="car-select-service" class="block text-sm font-medium text-gray-700 mb-1">Select Existing Vehicle (for this client):</label>
                        <select id="car-select-service" class="w-full p-3 border rounded-lg focus:ring-purple-500 focus:border-purple-500" onchange="autofillVehicleDetails('service')">
                            <option value="">-- New Vehicle Entry --</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
                        <input id="service-plate" type="text" placeholder="Vehicle Number Plate" required class="p-3 border rounded-lg" />
                        <input id="service-make" type="text" placeholder="Make" required class="p-3 border rounded-lg" />
                        <input id="service-model" type="text" placeholder="Model" required class="p-3 border rounded-lg" />
                        <input id="service-vin" type="text" placeholder="VIN / Chassis No. (Optional)" class="p-3 border rounded-lg" />
                    </div>
                </fieldset>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <fieldset class="border-2 border-green-200 p-4 rounded-lg">
                        <legend class="text-xl font-semibold text-green-700 px-2">Fluids & Filters</legend>
                        <table class="w-full service-table text-sm">
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Faulty</th>
                                    <th>Checked</th>
                                    <th>Changed</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody id="fluids-filters-body">
                                </tbody>
                        </table>
                    </fieldset>

                    <fieldset class="border-2 border-yellow-200 p-4 rounded-lg">
                        <legend class="text-xl font-semibold text-yellow-700 px-2">Lights & Electrical</legend>
                        <table class="w-full service-table text-sm">
                            <thead>
                                <tr>
                                    <th>Light</th>
                                    <th>L/H Working</th>
                                    <th>R/H Working</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody id="lights-body">
                                </tbody>
                        </table>
                    </fieldset>
                    
                    <fieldset class="border-2 border-red-200 p-4 rounded-lg col-span-1 lg:col-span-2">
                        <legend class="text-xl font-semibold text-red-700 px-2">Brakes, Tyres & Other Critical Checks</legend>
                        <table class="w-full service-table text-sm">
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Faulty</th>
                                    <th>Checked</th>
                                    <th>Changed</th>
                                    <th>Notes</th>
                                </tr>
                            </thead>
                            <tbody id="other-checks-body">
                                </tbody>
                        </table>
                    </fieldset>
                </div>
                
                <fieldset class="border-2 border-gray-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-gray-700 px-2">Mechanic Comments & Notes</legend>
                    <textarea id="service-comments" rows="4" placeholder="Enter any general comments, recommended repairs, or additional notes here." class="w-full p-3 border rounded-lg mt-4"></textarea>
                </fieldset>
                <fieldset class="border-2 border-indigo-200 p-4 rounded-lg">
                    <legend class="text-xl font-semibold text-indigo-700 px-2">Mileage & Service Handover</legend>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-4">
                        <input id="current-mileage" type="number" placeholder="Current Mileage (KM)" required class="p-3 border rounded-lg" />
                        <input id="next-service-mileage" type="number" placeholder="Next Service Est. Mileage (KM)" required class="p-3 border rounded-lg" />
                        <input id="service-person" type="text" placeholder="Service Person Name" required class="p-3 border rounded-lg" />
                    </div>
                </fieldset>

                <div class="flex justify-end pt-4 space-x-4">
                    <button type="button" onclick="completeServiceJob()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg transition duration-150">Complete Job & Save</button>
                    <button type="button" onclick="generateServiceReportPDF()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-150">Generate Service Report (PDF)</button>
                </div>
                </form>
        </section>

        <section id="clients-section" class="space-y-8" style="display:none;">
            <h2 class="text-3xl font-bold text-gray-800 border-b pb-2">üë• Client Management</h2>
            
            <div class="bg-white p-6 rounded-xl shadow-lg">
                <h3 class="text-2xl font-semibold text-indigo-700 mb-4 border-b pb-2">‚ûï Register New Client</h3>
                <form id="create-client-form" onsubmit="saveNewClient(event)" class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <input id="new-client-name" type="text" placeholder="Client Full Name" required class="p-3 border rounded-lg" />
                        <input id="new-client-phone" type="tel" placeholder="Phone Number (Unique ID)" required class="p-3 border rounded-lg" pattern="^\+?[0-9\s\-\(\)]+$" title="Enter a valid phone number, e.g., +2547..." />
                        <input id="new-client-email" type="email" placeholder="Email (Optional)" class="p-3 border rounded-lg" />
                        <input id="new-client-address" type="text" placeholder="Physical Address (City/Town)" class="p-3 border rounded-lg" />
                    </div>
                    <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg transition duration-150">Save Client to Database</button>
                    <p id="client-save-message" class="text-sm mt-2"></p>
                </form>
            </div>

            <div class="mt-8">
                <h3 class="text-2xl font-semibold text-teal-700 mb-4 border-b pb-2">üìã All Registered Clients (<span id="client-count">0</span>)</h3>
                <input type="text" id="client-search" placeholder="Search clients by Name or Phone..." class="w-full p-3 border rounded-lg mb-4 focus:ring-teal-500 focus:border-teal-500" oninput="filterClients()" />
                <div id="clients-list-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <p class="text-center text-gray-500 py-10 col-span-full" id="no-clients-message">Loading clients...</p>
                </div>
            </div>
        </section>
        
        <section id="car-list" style="display:none;">
            <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">üìã Active Jobs & Work in Progress</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="car-list-container">
                </div>
        </section>
        
        <section id="completed-list" style="display:none;">
            <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">‚úÖ Completed Jobs (History)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="completed-list-container">
                </div>
        </section>

        <section id="reports-section" style="display:none;">
            <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">üìä Daily & Monthly Analytics</h2>
            
            <div class="bg-white p-6 rounded-xl shadow-lg space-y-6">
                <h3 class="text-xl font-semibold text-blue-700">End-of-Day Operations Summary</h3>
                <p class="text-gray-600">Click the button below to generate a report summarizing all jobs marked as completed today.</p>
                <button onclick="generateDailyReport()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg transition duration-150">Generate Today's Report</button>
            </div>

            <div class="mt-8 bg-gray-100 p-6 rounded-xl shadow-inner space-y-6">
                <h3 class="text-xl font-semibold text-gray-700 border-b pb-2">Monthly Compilation & Analytics</h3>
                <p class="text-gray-500">Generate a comprehensive report summarizing all completed jobs over the last 30 days. This aggregates data for monthly performance review.</p>
                <button onclick="generateMonthlyReport()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-lg transition duration-150">Generate Monthly Report</button>
            </div>
        </section>
        <div id="jobCardModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[100]" style="display:none;">
            <div id="job-card-dialog" class="bg-white p-8 rounded-lg shadow-xl w-full max-w-3xl custom-scrollbar max-h-[90vh] overflow-y-auto">
                <div class="text-center border-b pb-4 mb-4">
                    <h2 class="text-3xl font-bold text-blue-800">Vehicle Job Detail Report</h2>
                    <p class="text-sm text-gray-600">Garage Manager PRO - The Ultimate Auto Service Tool</p>
                </div>
                <div id="job-card-content" class="space-y-4 text-gray-700">
                    </div>
                <div class="flex justify-end space-x-4 mt-6" id="job-card-actions">
                    <button onclick="document.getElementById('jobCardModal').style.display = 'none'" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition duration-150 print:hidden">Close</button>
                    <button id="whatsapp-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded transition duration-150 print:hidden">Send via WhatsApp</button>
                    <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-150 print:hidden">Print Job Card</button>
                </div>
            </div>
        </div>
        
        <div id="dailyReportModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[100]" style="display:none;">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-4xl custom-scrollbar max-h-[90vh] overflow-y-auto">
                <div class="text-center border-b pb-4 mb-4">
                    <h2 class="text-3xl font-bold text-blue-800">End-of-Day Report: <span id="report-date"></span></h2>
                    <p class="text-sm text-gray-600">Summary of all jobs completed on this date.</p>
                </div>
                <div id="report-content" class="space-y-6 text-gray-700">
                    </div>
                <div class="flex justify-end mt-6 space-x-4">
                    <button id="dailyDownloadBtn" data-report-type="daily" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition duration-150">Download PDF</button>
                    <button onclick="document.getElementById('dailyReportModal').style.display = 'none'" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition duration-150">Close</button>
                </div>
            </div>
        </div>
        <div id="monthlyReportModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-[100]" style="display:none;">
            <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-5xl custom-scrollbar max-h-[90vh] overflow-y-auto">
                <div class="text-center border-b pb-4 mb-4">
                    <h2 class="text-3xl font-bold text-purple-800">Monthly Performance Report</h2>
                    <p class="text-sm text-gray-600">Summary of all jobs completed between <span id="monthly-report-start"></span> and <span id="monthly-report-end"></span>.</p>
                </div>
                <div id="monthly-report-content" class="space-y-6 text-gray-700">
                    </div>
                <div class="flex justify-end mt-6 space-x-4">
                    <button id="monthlyDownloadBtn" data-report-type="monthly" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition duration-150">Download PDF</button>
                    <button onclick="document.getElementById('monthlyReportModal').style.display = 'none'" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded transition duration-150">Close</button>
                </div>
            </div>
        </div>
        </main>

    <footer class="bg-gray-800 text-white text-center py-4 mt-8">
        <p class="text-sm">¬© 2025 Garage Manager PRO | Powered by Tailwind & Firebase</p>
    </footer>

<script type="module">

    // NEW: Import the local error code dictionary
    import { ERROR_CODE_LOOKUP } from "./error_codes_dictionary.js";
    // MODIFICATION 2: Expose dictionary globally for functions called via onclick to access
    window.GLOBAL_ERROR_CODE_LOOKUP = ERROR_CODE_LOOKUP; 
    
    // ----------------------------------------------------------------------
    // 1. FIREBASE INITIALIZATION & CONFIGURATION (MODULAR)
    // ----------------------------------------------------------------------

    // Import the functions you need from the SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
    import { getFirestore, collection, addDoc, doc, updateDoc, deleteDoc, query, where, orderBy, onSnapshot, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js"; // Note: Added 'where' for client lookup

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyBCvFltNyGj3SYR-ADUocWD5EVjljoCEp8",
        authDomain: "garage-manager-1ac7c.firebaseapp.com",
        projectId: "garage-manager-1ac7c",
        storageBucket: "garage-manager-1ac7c.firebasestorage.app",
        messagingSenderId: "226684256206",
        appId: "1:226684256206:web:13d600d6db4c603506759f"
    };

    // Initialize Firebase Services
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const carsCollection = collection(db, 'cars');
    // NEW: Clients Collection
    const clientsCollection = collection(db, 'clients'); 
    let currentUserRole = null; // 'admin' or 'mechanic'

    // FIX: Global variable to hold current job card data for modal and WhatsApp
    // It is now explicitly attached to window to be accessible by inline onclick handlers.
    window.currentJobCardData = null; 
    // NEW: Global cache for completed jobs to power the daily report
    let completedJobsCache = []; 
    // NEW: Global cache for all clients and their cars for search/autofill
    let clientCache = []; // Stores {id, clientName, clientPhone, clientEmail, ...}
    let clientCarsCache = {}; // Stores {clientPhone: [carData, ...]}
    let currentClientVehicles = []; // Temp storage for vehicles associated with the looked-up client
    // NEW: Global variables to temporarily hold the report data for PDF generation
    let currentReportJobs = [];
    let currentReportSummary = {};
    let currentReportTitle = "";
    let currentReportDateRange = "";

    // EXPOSE PDF FUNCTION
    // ----------------------------------------------------------------------
    // 1. CHECKLIST DATA DEFINITION (NEW)
    // ----------------------------------------------------------------------
    const FLUIDS_FILTERS_ITEMS = [
        'Engine Oil', 'Oil Filter', 'Air Filter', 'Fuel Filter', 
        'Cabin Filter', 'Brake Fluid', 'Power Steering Fluid', 
        'Coolant Level', 'Transmission Fluid'
    ];

    const LIGHTS_ELECTRICAL_ITEMS = [
        'Headlights (Low Beam)', 'Headlights (High Beam)', 'Turn Signals (Front)', 
        'Turn Signals (Rear)', 'Brake Lights', 'Reverse Lights', 'License Plate Light', 
        'Battery Health/Terminals', 'Horn'
    ];

    const CRITICAL_CHECKS_ITEMS = [
        'Front Brake Pads/Shoes', 'Rear Brake Pads/Shoes', 'Brake Discs/Drums', 
        'Handbrake Operation', 'Front Tyres (Tread/Pressure)', 'Rear Tyres (Tread/Pressure)', 
        'Spare Tyre (Tread/Pressure)', 'Wiper Blades', 'Suspension/Shock Absorbers',
        'Steering Linkages', 'Exhaust System'
    ];

    // Expose functions globally for HTML onclick attributes
    // NOTE: showSection is *not* exposed here; its handlers are attached via DOMContentLoaded
    window.handleLoginSignup = handleLoginSignup;
    window.addErrorCodeInput = addErrorCodeInput;
    window.removeErrorCodeInput = removeErrorCodeInput;
    window.lookupErrorCode = lookupErrorCode;
    window.createJobCard = createJobCard;
    window.generateAnalysisReportPDF = generateAnalysisReportPDF;
    window.generateServiceReportPDF = generateServiceReportPDF;
    window.markCarAsCompleted = markCarAsCompleted;
    window.deleteCompletedCar = deleteCompletedCar;
    window.openDetailedReport = openDetailedReport;
    window.addRepairPlanCard = addRepairPlanCard;
    window.removeRepairPlanCard = removeRepairPlanCard;
    window.sendJobCardViaWhatsApp = sendJobCardViaWhatsApp;
    window.completeServiceJob = completeServiceJob;
    // START NEW: Expose the daily & monthly report functions
    window.generateDailyReport = generateDailyReport;
    window.generateMonthlyReport = generateMonthlyReport;
    window.generateReportPDF = generateReportPDF; // EXPOSE PDF FUNCTION
    // END NEW
    // START NEW: Client Management Functions
    window.saveNewClient = saveNewClient;
    window.openClientVehiclesModal = openClientVehiclesModal;
    window.filterClients = filterClients;
    window.lookupClientDetails = lookupClientDetails;
    window.autofillVehicleDetails = autofillVehicleDetails;
    // END NEW
    
    // ----------------------------------------------------------------------
    // 2. AUTHENTICATION LOGIC (EXISTING)
    // ----------------------------------------------------------------------
    onAuthStateChanged(auth, (user) => { 
        const headerNav = document.querySelector('header nav'); 
        if (user) { 
            currentUserRole = getMockRole(user.email); 
            document.getElementById('logoutBtn').style.display = 'block'; 
            headerNav.style.display = 'flex'; 
            listenForClients(); 
            listenForCarsForCache(); 
            showSection('car-list'); 
        } else { 
            document.getElementById('logoutBtn').style.display = 'none'; 
            headerNav.style.display = 'none'; 
            showSection('auth-section'); 
        } 
    }); 
    
    function showSection(sectionId) { 
        const sections = ['auth-section', 'car-entry', 'general-service', 'clients-section', 'car-list', 'completed-list', 'reports-section']; 
        sections.forEach(id => { 
            document.getElementById(id).style.display = 'none'; 
        }); 
        document.getElementById(sectionId).style.display = 'block'; 
        if (sectionId === 'car-list') fetchCars('Active'); 
        if (sectionId === 'completed-list') fetchCars('Completed'); 
        if (sectionId === 'general-service') initializeGeneralService(); 
        if (sectionId === 'clients-section') renderClientList(clientCache); 
    } 
    
    function getMockRole(email) { 
        return email && email.toLowerCase().includes('admin') ? 'admin' : 'mechanic'; 
    } 
    
    async function handleLoginSignup(isLogin) { 
        const email = document.getElementById('auth-email').value; 
        const password = document.getElementById('auth-password').value; 
        const messageEl = document.getElementById('auth-message'); 
        messageEl.textContent = ''; 
        try { 
            if (isLogin) { 
                await signInWithEmailAndPassword(auth, email, password); 
            } else { 
                if (email && !email.toLowerCase().includes('admin')) { 
                    messageEl.textContent = 'Error: Only Admins can sign up new accounts.'; 
                    return; 
                } 
                await createUserWithEmailAndPassword(auth, email, password); 
            } 
        } catch (error) { 
            messageEl.textContent = `Error: ${error.message}`; 
        } 
    } 
    
    document.getElementById('logoutBtn').onclick = () => { 
        signOut(auth).then(() => { 
            currentUserRole = null; 
        }); 
    }; 
    
    // ----------------------------------------------------------------------
    // 3. LOGIN ENHANCEMENT (EXISTING)
    // ----------------------------------------------------------------------
    document.getElementById('auth-password').addEventListener('keypress', function(e) { 
        if (e.key === 'Enter') { 
            e.preventDefault(); 
            document.getElementById('loginBtn').click(); 
        } 
    }); 
    
    // ----------------------------------------------------------------------
    // 4. CRUD OPERATIONS (Firestore - PARTIAL)
    // ----------------------------------------------------------------------
    // Function to save new car entry (omitted for brevity)
    async function saveCarEntry(event) { /* ... existing logic ... */ } 
    // Function to fetch cars (omitted for brevity)
    function fetchCars(status) { /* ... existing logic ... */ }
    // Function to listen for clients (omitted for brevity)
    function listenForClients() { /* ... existing logic ... */ }
    // Function to listen for cars for cache (omitted for brevity)
    function listenForCarsForCache() { /* ... existing logic ... */ }
    // Function to lookup client details (omitted for brevity)
    function lookupClientDetails(source) { /* ... existing logic ... */ }
    // Function to autofill vehicle details (omitted for brevity)
    function autofillVehicleDetails(source) { /* ... existing logic ... */ }
    // Function to save new client (omitted for brevity)
    async function saveNewClient(event) { /* ... existing logic ... */ }
    // Function to create job card (omitted for brevity)
    function createJobCard() { /* ... existing logic ... */ }
    // Function to generate analysis report PDF (omitted for brevity)
    function generateAnalysisReportPDF() { /* ... existing logic ... */ }
    // Function to add error code input (omitted for brevity)
    function addErrorCodeInput() { /* ... existing logic ... */ }
    // Function to add repair plan card (omitted for brevity)
    function addRepairPlanCard(description = 'New repair/action item.', status = 'Pending') { /* ... existing logic ... */ }
    // Function to render client list (omitted for brevity)
    function renderClientList(clients) { /* ... existing logic ... */ }
    // Function to open client vehicles modal (omitted for brevity)
    function openClientVehiclesModal(clientPhone) { /* ... existing logic ... */ }
    // Function to filter clients (omitted for brevity)
    function filterClients() { /* ... existing logic ... */ }
    // Function to generate daily report (omitted for brevity)
    function generateDailyReport() { /* ... existing logic ... */ }
    // Function to generate monthly report (omitted for brevity)
    function generateMonthlyReport() { /* ... existing logic ... */ }
    // Function to generate report PDF (omitted for brevity)
    function generateReportPDF(reportType) { /* ... existing logic ... */ }


    // ----------------------------------------------------------------------
    // 5. GENERAL SERVICE LOGIC (MODIFIED & NEW)
    // ----------------------------------------------------------------------

    /**
     * Renders the service checklist tables with default items and inputs. (NEW)
     */
    function initializeGeneralServiceChecklist() {
        // Helper to create checkbox/input HTML
        const checkbox = (type, color) => `<input type="checkbox" data-check-type="${type}" class="form-checkbox h-5 w-5 ${color} rounded" />`;
        const textInput = (type) => `<input type="text" data-check-type="${type}" placeholder="Notes" class="w-full text-sm p-1 border rounded" />`;
        
        // 1. Fluids & Filters
        const fluidsBody = document.getElementById('fluids-filters-body');
        fluidsBody.innerHTML = FLUIDS_FILTERS_ITEMS.map(item => `
            <tr data-item-name="${item.replace(/\s/g, '-')}-f">
                <td>${item}</td>
                <td class="text-center">${checkbox('faulty', 'text-red-600')}</td>
                <td class="text-center">${checkbox('checked', 'text-green-600')}</td>
                <td class="text-center">${checkbox('changed', 'text-blue-600')}</td>
                <td>${textInput('notes')}</td>
            </tr>
        `).join('');

        // 2. Lights & Electrical
        const lightsBody = document.getElementById('lights-body');
        lightsBody.innerHTML = LIGHTS_ELECTRICAL_ITEMS.map(item => `
            <tr data-item-name="${item.replace(/\s/g, '-')}-l">
                <td>${item}</td>
                <td class="text-center">${item.includes('Battery') || item.includes('Horn') ? 'N/A' : checkbox('lhWorking', 'text-green-600')}</td>
                <td class="text-center">${item.includes('Battery') || item.includes('Horn') ? 'N/A' : checkbox('rhWorking', 'text-green-600')}</td>
                <td>${textInput('notes')}</td>
            </tr>
        `).join('');
        
        // 3. Brakes, Tyres & Other Critical Checks
        const otherBody = document.getElementById('other-checks-body');
        otherBody.innerHTML = CRITICAL_CHECKS_ITEMS.map(item => `
            <tr data-item-name="${item.replace(/\s/g, '-')}-c">
                <td>${item}</td>
                <td class="text-center">${checkbox('faulty', 'text-red-600')}</td>
                <td class="text-center">${checkbox('checked', 'text-green-600')}</td>
                <td class="text-center">${item.includes('Tyre') || item.includes('Brake') || item.includes('Wiper') ? checkbox('changed', 'text-blue-600') : 'N/A'}</td>
                <td>${textInput('notes')}</td>
            </tr>
        `).join('');

        // Clear comments field on initialization
        document.getElementById('service-comments').value = '';
    }

    /**
     * Initializes the general service tab (MODIFIED)
     */
    function initializeGeneralService() {
        // ... (Existing logic for client/car autofill)
        
        // NEW: Call the checklist initialization
        initializeGeneralServiceChecklist();
    }
    
    /**
     * Collects all checklist data from the form (NEW)
     */
    function collectServiceChecklistData() {
        const data = {
            fluidsFilters: [],
            lightsElectrical: [],
            criticalChecks: []
        };

        // Helper function to process tables
        function processTable(tbodyId, targetArray) {
            const tbody = document.getElementById(tbodyId);
            if (tbody) {
                tbody.querySelectorAll('tr').forEach(row => {
                    const item = row.querySelector('td:first-child').textContent.trim();
                    const itemData = { item };

                    row.querySelectorAll('input, textarea').forEach(input => {
                        const checkType = input.getAttribute('data-check-type');
                        if (input.type === 'checkbox') {
                            // Collect checkbox state, default to N/A for those fields that are 'N/A' in HTML
                            if (input.closest('td').textContent.trim() === 'N/A') {
                                itemData[checkType] = 'N/A';
                            } else {
                                itemData[checkType] = input.checked;
                            }
                        } else if (input.type === 'text') {
                            itemData[checkType] = input.value.trim();
                        }
                    });

                    // Flatten specific light fields if they exist
                    if (tbodyId === 'lights-body') {
                        // Ensure all expected fields are present, using collected values or defaults/N/A
                        itemData.lhWorking = itemData.lhWorking !== undefined ? itemData.lhWorking : 'N/A';
                        itemData.rhWorking = itemData.rhWorking !== undefined ? itemData.rhWorking : 'N/A';
                        // Clean up temporary keys that are not needed for Lights
                        delete itemData.faulty; delete itemData.checked; delete itemData.changed;
                    }

                    targetArray.push(itemData);
                });
            }
        }

        processTable('fluids-filters-body', data.fluidsFilters);
        processTable('lights-body', data.lightsElectrical);
        processTable('other-checks-body', data.criticalChecks);

        return data;
    }


    /**
     * Completes a general service job by saving data and updating status (MODIFIED)
     */
    async function completeServiceJob() {
        if (!auth.currentUser) {
            alert("You must be logged in to complete a service.");
            return;
        }

        const carSelect = document.getElementById('car-select-service');
        const carId = carSelect.value;
        
        if (!carId) {
            alert("Please select a vehicle from the list of active jobs to complete the service for.");
            return;
        }

        const currentMileage = document.getElementById('current-mileage').value;
        const nextServiceMileage = document.getElementById('next-service-mileage').value;
        const servicePerson = document.getElementById('service-person').value;
        const serviceComments = document.getElementById('service-comments').value; // NEW

        if (!currentMileage || !nextServiceMileage || !servicePerson) {
            alert("Please fill in current mileage, next service mileage, and service person name.");
            return;
        }

        // NEW: Collect detailed checklist data
        const serviceChecklist = collectServiceChecklistData();
        
        // Find the car object in the active jobs cache to get its original data
        // Assumes window.activeJobsCache is available and populated by fetchCars('Active')
        const carToComplete = window.activeJobsCache ? window.activeJobsCache.find(car => car.id === carId) : null;

        if (!carToComplete) {
            alert("Selected vehicle not found in active jobs cache. Please try reloading the Active Jobs list first.");
            return;
        }

        try {
            const carRef = doc(db, 'cars', carId);
            
            // Update the document with service completion details
            await updateDoc(carRef, {
                status: 'Completed',
                completedDate: serverTimestamp(),
                currentMileage: parseInt(currentMileage),
                nextServiceMileage: parseInt(nextServiceMileage),
                servicePerson: servicePerson,
                serviceType: 'General Service',
                // NEW: Save service checklist data and comments
                serviceChecklist: serviceChecklist, 
                mechanicComments: serviceComments 
            });
            
            alert(`Service for ${carToComplete.numberPlate} successfully completed and saved!`);
            showSection('completed-list'); // Move to completed list
        } catch (error) {
            console.error("Error completing service job: ", error);
            alert("Failed to complete service job. See console for details.");
        }
    }


    /**
     * Generates a PDF report for the completed General Service job (NEW/MODIFIED)
     */
    function generateServiceReportPDF() {
        const carSelect = document.getElementById('car-select-service');
        const carId = carSelect.value;
        const carData = window.activeJobsCache.find(car => car.id === carId) || window.completedJobsCache.find(car => car.id === carId);

        if (!carData) {
            alert("Please select a vehicle or select a car with completed data to generate a report.");
            return;
        }

        // For unsaved/in-progress service, collect the current data from the form
        const isCurrentJob = carData.status !== 'Completed';
        const serviceData = isCurrentJob ? {
            serviceChecklist: collectServiceChecklistData(),
            currentMileage: document.getElementById('current-mileage').value,
            nextServiceMileage: document.getElementById('next-service-mileage').value,
            servicePerson: document.getElementById('service-person').value,
            mechanicComments: document.getElementById('service-comments').value,
            completedDate: new Date() 
        } : carData;

        if (!serviceData.serviceChecklist) {
            alert("Service checklist data is missing for the report.");
            return;
        }

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let currentY = 14;

        // Header
        doc.setFontSize(22);
        doc.setTextColor(30, 64, 175); // Blue-700
        doc.text("General Service Report", 105, currentY, { align: "center" });
        currentY += 8;
        
        doc.setFontSize(10);
        doc.setTextColor(107, 114, 128); // Gray-500
        doc.text(`Report Date: ${new Date(serviceData.completedDate.toDate ? serviceData.completedDate.toDate() : serviceData.completedDate).toLocaleDateString()}`, 105, currentY, { align: "center" });
        currentY += 10;
        
        // Client and Vehicle Details Table
        doc.setFontSize(14);
        doc.setTextColor(0, 0, 0); 
        doc.text("Client & Vehicle Details", 14, currentY);
        currentY += 5;

        const detailsData = [
            ['Client Name', carData.clientName || 'N/A', 'Plate No.', carData.numberPlate || 'N/A'],
            ['Phone', carData.clientPhone || 'N/A', 'Make/Model', `${carData.make || 'N/A'} / ${carData.model || 'N/A'}`],
            ['Current Mileage (KM)', serviceData.currentMileage || 'N/A', 'Next Service Est. (KM)', serviceData.nextServiceMileage || 'N/A'],
            ['Service Done By', serviceData.servicePerson || 'N/A', 'VIN/Chassis', carData.vin || 'N/A']
        ];

        doc.autoTable({
            startY: currentY,
            body: detailsData,
            theme: 'grid',
            headStyles: { fillColor: [249, 250, 251], textColor: [0, 0, 0] },
            styles: { fontSize: 10, cellPadding: 2, lineWidth: 0.1, lineColor: [229, 231, 235] },
            columnStyles: { 0: { fontStyle: 'bold', fillColor: [243, 244, 246] }, 2: { fontStyle: 'bold', fillColor: [243, 244, 246] } },
            margin: { left: 14, right: 14 }
        });
        currentY = doc.autoTable.previous.finalY + 8;
        
        // Helper to draw a checklist table
        function drawChecklistTable(title, data, headers) {
            if (currentY > 280) { doc.addPage(); currentY = 14; }

            doc.setFontSize(14);
            doc.setTextColor(30, 64, 175);
            doc.text(title, 14, currentY);
            currentY += 5;
            
            // Prepare table body data
            const tableBody = data.map(item => {
                if (title === "Lights & Electrical") {
                    return [
                        item.item,
                        item.lhWorking === true ? '‚úÖ' : item.lhWorking === 'N/A' ? 'N/A' : '‚ùå',
                        item.rhWorking === true ? '‚úÖ' : item.rhWorking === 'N/A' ? 'N/A' : '‚ùå',
                        item.notes || ''
                    ];
                } else {
                    return [
                        item.item,
                        item.faulty === true ? '‚ùå' : item.faulty === 'N/A' ? 'N/A' : '‚úÖ',
                        item.checked === true ? '‚úÖ' : item.checked === 'N/A' ? 'N/A' : '‚ùå',
                        item.changed === true ? '‚úÖ' : item.changed === 'N/A' ? 'N/A' : '‚ùå',
                        item.notes || ''
                    ];
                }
            });

            doc.autoTable({
                startY: currentY,
                head: [headers],
                body: tableBody,
                theme: 'striped',
                headStyles: { fillColor: [52, 73, 94], textColor: [255, 255, 255], fontSize: 10 },
                styles: { fontSize: 9, cellPadding: 2 },
                margin: { left: 14, right: 14 }
            });

            currentY = doc.autoTable.previous.finalY + 8;
        }

        // Checklist Tables
        drawChecklistTable(
            "Fluids & Filters Check", 
            serviceData.serviceChecklist.fluidsFilters,
            ['Item', 'Faulty', 'Checked', 'Changed', 'Notes']
        );

        drawChecklistTable(
            "Lights & Electrical Check", 
            serviceData.serviceChecklist.lightsElectrical,
            ['Light', 'L/H Working', 'R/H Working', 'Notes']
        );

        drawChecklistTable(
            "Brakes, Tyres & Other Critical Checks", 
            serviceData.serviceChecklist.criticalChecks,
            ['Item', 'Faulty', 'Checked', 'Changed', 'Notes']
        );

        // Mechanic Comments
        if (currentY > 280) { doc.addPage(); currentY = 14; }
        doc.setFontSize(14);
        doc.setTextColor(30, 64, 175);
        doc.text("Mechanic Comments", 14, currentY);
        currentY += 5;
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0); 
        const splitComments = doc.splitTextToSize(serviceData.mechanicComments || 'No general comments were recorded for this service.', 180);
        doc.text(splitComments, 14, currentY);
        currentY += splitComments.length * 4 + 5;
        
        // Footer (Signature placeholder)
        if (currentY > 280) { doc.addPage(); currentY = 14; }
        doc.setFontSize(10);
        doc.text("_________________________", 14, currentY + 10);
        doc.text("Mechanic Signature", 14, currentY + 15);
        doc.text("_________________________", 140, currentY + 10);
        doc.text("Client Signature", 140, currentY + 15);

        // Save the PDF
        doc.save(`Service_Report_${carData.numberPlate}.pdf`);
    }

    // ----------------------------------------------------------------------
    // 6. INITIALIZATION (EXISTING)
    // ----------------------------------------------------------------------

    document.addEventListener('DOMContentLoaded', () => {
        function attachNavHandlers() {
            const navButtons = [
                { id: 'nav-car-entry', section: 'car-entry' },
                { id: 'nav-general-service', section: 'general-service' },
                // NEW: Clients button
                { id: 'nav-clients-list', section: 'clients-section' },
                { id: 'nav-car-list', section: 'car-list' },
                { id: 'nav-completed-list', section: 'completed-list' },
                { id: 'nav-reports-section', section: 'reports-section' }
            ];

            navButtons.forEach(({ id, section }) => {
                const button = document.getElementById(id);
                if (button) {
                    // Use a proper event listener instead of inline onclick
                    button.addEventListener('click', () => showSection(section));
                }
            });
        }
        
        attachNavHandlers();
        
        // Initialize the first error code input field
        addErrorCodeInput(); 
        // MODIFICATION 3: Initialize the first repair plan card
        addRepairPlanCard('Full diagnostic and repair of error codes.', '');

        // MODIFICATION 4: Attach WhatsApp handler to the button element in the modal
        document.getElementById('whatsapp-btn').onclick = sendJobCardViaWhatsApp;
        
        // NEW: Attach PDF handlers to the report modals
        document.getElementById('dailyDownloadBtn').onclick = () => generateReportPDF('daily');
        document.getElementById('monthlyDownloadBtn').onclick = () => generateReportPDF('monthly');
    });

</script>

</body>
</html>
