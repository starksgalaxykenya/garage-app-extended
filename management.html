<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garage Management Console (GMC)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>

    <style>
        .active-tab {
            @apply bg-indigo-700 text-white;
        }
        .tab-button {
            @apply p-3 text-sm font-medium transition duration-150 hover:bg-indigo-200 text-indigo-800 rounded-lg;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">

    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore-compat.js"></script>

    <header class="bg-indigo-800 shadow-lg sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-extrabold text-white">Garage Management Console (GMC)</h1>
                <p class="text-sm text-indigo-200">Secure Finance, Inventory, & Supplier Control</p>
            </div>
            <nav class="flex space-x-4 items-center">
                <button onclick="window.location.href = 'index.html'" 
                        class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded transition duration-150 flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Garage Manager PRO
                </button>
                <button id="managementLogoutBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition duration-150" style="display:none;">Logout</button>
            </nav>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <section id="auth-section-management" class="flex justify-center items-center py-16 min-h-screen" style="display:none;">
            <div class="bg-white p-8 rounded-xl shadow-2xl w-full max-w-md">
                <h2 class="text-2xl font-bold mb-6 text-center text-indigo-800">Secure Management Login</h2>
                <p class="text-sm text-center text-gray-600 mb-4">Access limited to finance & inventory personnel only.</p>
                <input id="management-email" type="email" placeholder="Management Email" class="w-full p-3 mb-4 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" />
                <input id="management-password" type="password" placeholder="Password" class="w-full p-3 mb-6 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" />
                <button id="managementLoginBtn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition duration-150 mb-3">Login</button>
                <p id="management-auth-message" class="text-red-500 text-sm mt-3 text-center"></p>
            </div>
        </section>

        <section id="management-dashboard" class="space-y-8" style="display:none;">
            
            <div class="flex bg-white p-2 rounded-xl shadow-lg space-x-2" id="tab-nav">
                <button id="tab-finance" class="tab-button active-tab"><i class="fas fa-chart-line mr-2"></i>Finance & Reports</button>
                <button id="tab-inventory" class="tab-button"><i class="fas fa-warehouse mr-2"></i>Parts Inventory</button>
                <button id="tab-suppliers" class="tab-button"><i class="fas fa-users-cog mr-2"></i>Suppliers & Contacts</button>
                <button id="tab-invoices" class="tab-button"><i class="fas fa-file-invoice mr-2"></i>Receipts & Invoices</button>
                <button id="tab-quotes" class="tab-button"><i class="fas fa-file-alt mr-2"></i>Repair Quotes</button>
            </div>

            <div id="content-finance" class="tab-content">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Finance & Operational Reports</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Record Daily Job / Income / Expense</h3>
                        
                        <h4 class="font-medium text-gray-700 mt-4 mb-2">Job Transaction</h4>
                        <form id="finance-job-form" class="grid grid-cols-4 gap-4 bg-gray-50 p-4 rounded-lg">
                            <select id="job-type" class="p-2 border rounded-lg" required>
                                <option value="">Job Type</option>
                                <option value="Repair">Repair</option>
                                <option value="General Service">General Service</option>
                                <option value="Diagnostic">Diagnostic</option>
                                <option value="Other">Other Income</option>
                            </select>
                            <input id="job-plate" type="text" placeholder="Car Plate (Optional)" class="p-2 border rounded-lg" />
                            <input id="job-income" type="number" placeholder="Total Income ($)" required class="p-2 border rounded-lg" step="0.01" min="0" />
                            <input id="job-expense" type="number" placeholder="Job Expense/Wages ($)" required class="p-2 border rounded-lg" step="0.01" min="0" />
                            <div class="col-span-4 flex justify-between items-center">
                                <span id="job-profit-display" class="font-bold text-lg text-green-600">Profit: $0.00</span>
                                <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-150"><i class="fas fa-plus mr-2"></i>Record Job</button>
                            </div>
                        </form>

                        <h4 class="font-medium text-gray-700 mt-6 mb-2">General Transaction</h4>
                        <form id="finance-general-form" class="grid grid-cols-4 gap-4 bg-gray-50 p-4 rounded-lg">
                            <select id="general-type" class="p-2 border rounded-lg" required>
                                <option value="">Transaction Type</option>
                                <option value="Supplies Bought">Supplies Bought</option>
                                <option value="Parts Restock">Parts Restock</option>
                                <option value="Utility Expense">Utility Expense</option>
                                <option value="Salary Expense">Staff Salaries</option>
                                <option value="Other Expense">Other Expense</option>
                                <option value="Other Income">Other Income</option>
                            </select>
                            <input id="general-amount" type="number" placeholder="Amount ($)" required class="p-2 border rounded-lg col-span-2" step="0.01" min="0" />
                            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-150"><i class="fas fa-save mr-2"></i>Record General</button>
                        </form>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-lg space-y-4">
                        <h3 class="text-xl font-semibold text-red-700 border-b pb-2">Daily Summary</h3>
                        <div id="daily-summary-stats" class="space-y-2 text-sm">
                            <p>Total Job Income: <span id="summary-income" class="font-bold text-green-600">$0.00</span></p>
                            <p>Total Job Expense: <span id="summary-expense" class="font-bold text-red-600">$0.00</span></p>
                            <p>Net Profit: <span id="summary-profit" class="font-bold text-indigo-600">$0.00</span></p>
                        </div>
                        <button id="end-day-btn" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 rounded-lg transition duration-150"><i class="fas fa-calendar-check mr-2"></i>End Day & Generate P&L</button>
                        <button id="view-reports-btn" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 rounded-lg transition duration-150"><i class="fas fa-file-invoice-dollar mr-2"></i>View Past Reports</button>
                    </div>
                </div>

                <div class="mt-8 bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Today's Transactions</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type / Description</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Plate</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-green-600">Income ($)</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-red-600">Expense ($)</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-indigo-600">Profit ($)</th>
                                    <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="daily-transactions-body" class="bg-white divide-y divide-gray-200">
                                </tbody>
                        </table>
                    </div>
                </div>

                <div id="report-view-section" class="mt-8 hidden">
                    <h3 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Financial Trends</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                            <h4 class="text-xl font-semibold mb-4 text-indigo-700">Monthly Profit/Loss Trend</h4>
                            <canvas id="pl-chart"></canvas>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-lg">
                            <h4 class="text-xl font-semibold mb-4 text-indigo-700">Past Daily Reports</h4>
                            <div class="space-y-3" id="past-reports-list">
                                <p class="text-gray-500">No reports found.</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div id="content-inventory" class="tab-content hidden">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Parts Inventory Management</h2>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="lg:col-span-1">
                            <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Add New Part</h3>
                            <form id="add-part-form" class="space-y-3 bg-gray-50 p-4 rounded-lg">
                                <input id="part-name" type="text" placeholder="Part Name (e.g., Oil Filter)" required class="w-full p-2 border rounded-lg" />
                                <input id="part-sku" type="text" placeholder="SKU/Part Number (Optional)" class="w-full p-2 border rounded-lg" />
                                <input id="part-quantity" type="number" placeholder="Initial Stock Quantity" required class="w-full p-2 border rounded-lg" min="1" />
                                <input id="part-supplier-price" type="number" placeholder="Supplier Cost (Unit Price $)" required class="w-full p-2 border rounded-lg" step="0.01" min="0" />
                                <input id="part-selling-price" type="number" placeholder="Selling Price (Unit Price $)" required class="w-full p-2 border rounded-lg" step="0.01" min="0" />
                                <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition duration-150"><i class="fas fa-box-open mr-2"></i>Add Part to Stock</button>
                            </form>
                            
                            <div class="mt-6">
                                <h3 class="text-xl font-semibold mb-4 text-green-700 border-b pb-2">Record Part Sale</h3>
                                <form id="sell-part-form" class="space-y-3 bg-gray-50 p-4 rounded-lg">
                                    <select id="part-sale-select" required class="w-full p-2 border rounded-lg">
                                        <option value="">Select Part to Sell</option>
                                    </select>
                                    <input id="part-sale-quantity" type="number" placeholder="Quantity Sold" required class="w-full p-2 border rounded-lg" min="1" />
                                    <input id="part-sale-plate" type="text" placeholder="Car Plate (Optional)" class="w-full p-2 border rounded-lg" />

                                    <div class="pt-2 border-t mt-4 flex justify-between items-center">
                                        <span class="font-bold">Est. Profit:</span>
                                        <span id="part-sale-profit-display" class="font-bold text-xl text-gray-500">$0.00</span>
                                    </div>
                                    <button id="commit-part-sale-btn" type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition duration-150" disabled><i class="fas fa-hand-holding-usd mr-2"></i>Commit Sale & Update Finance</button>
                                </form>
                            </div>
                        </div>

                        <div class="lg:col-span-2">
                            <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Current Stock Levels</h3>
                            <div class="overflow-x-auto">
                                <table class="min-w-full divide-y divide-gray-200">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Part Name (SKU)</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stock</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-red-600">Cost ($)</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider text-green-600">Selling ($)</th>
                                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="parts-inventory-body" class="bg-white divide-y divide-gray-200">
                                        </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="content-suppliers" class="tab-content hidden">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Supplier Management & Contacts</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Add New Supplier</h3>
                        <form id="add-supplier-form" class="space-y-3">
                            <input id="supplier-name" type="text" placeholder="Supplier Name" required class="w-full p-2 border rounded-lg" />
                            <input id="supplier-type" type="text" placeholder="Supplies Offered (e.g., Engine Parts, Oil, Tires)" required class="w-full p-2 border rounded-lg" />
                            <input id="supplier-contact" type="tel" placeholder="Contact Number (include country code, e.g., +123456789)" required class="w-full p-2 border rounded-lg" />
                            <input id="supplier-location" type="text" placeholder="Location / Address" required class="w-full p-2 border rounded-lg" />
                            <input id="supplier-owed" type="number" placeholder="Money Owed ($)" value="0.00" class="w-full p-2 border rounded-lg" step="0.01" min="0" />
                            <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition duration-150"><i class="fas fa-user-plus mr-2"></i>Save Supplier</button>
                        </form>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Request Supplies via WhatsApp</h3>
                        <select id="whatsapp-supplier-select" class="w-full p-2 border rounded-lg mb-3">
                            <option value="">Select Supplier</option>
                            </select>
                        <textarea id="supplies-list" placeholder="Enter supplies needed, one item per line (e.g., Oil Filter Z-45 x 10, Brake Pads - BMW x 5)" rows="6" class="w-full p-2 border rounded-lg mb-4"></textarea>
                        <button id="order-whatsapp-btn" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 rounded-lg transition duration-150" disabled><i class="fab fa-whatsapp mr-2"></i>Order via WhatsApp</button>
                    </div>
                </div>

                <div class="mt-8 bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Current Supplier List</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Supplies</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Owed ($)</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="suppliers-table-body" class="bg-white divide-y divide-gray-200">
                                </tbody>
                        </table>
                    </div>
                </div>

            </div>

            <div id="content-invoices" class="tab-content hidden">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Receipts & Invoices</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Create New Invoice</h3>
                        <form id="invoice-creation-form" class="space-y-3">
                            <input id="invoice-client-name" type="text" placeholder="Client Name" required class="w-full p-2 border rounded-lg" />
                            <input id="invoice-client-phone" type="tel" placeholder="Client Phone (+CCCXXXX)" required class="w-full p-2 border rounded-lg" />
                            <input id="invoice-car-plate" type="text" placeholder="Vehicle Plate" required class="w-full p-2 border rounded-lg" />
                            
                            <h4 class="font-medium text-gray-700 mt-4">Items (Labor/Parts)</h4>
                            <div id="invoice-items-container" class="space-y-2">
                                </div>
                            <button type="button" onclick="addInvoiceItemRow()" class="text-sm text-blue-600 hover:text-blue-800"><i class="fas fa-plus mr-1"></i>Add Item</button>

                            <div class="pt-2 border-t mt-4 flex justify-between items-center">
                                <span class="font-bold">Total:</span>
                                <span id="invoice-total-display" class="font-bold text-xl text-green-600">$0.00</span>
                            </div>
                            <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-lg transition duration-150"><i class="fas fa-file-export mr-2"></i>Generate & Commit Invoice</button>
                        </form>
                    </div>

                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Past Invoices & Receipts</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Invoice No.</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client / Plate</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount ($)</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="invoices-table-body" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="content-quotes" class="tab-content hidden">
                <h2 class="text-3xl font-bold text-gray-800 border-b pb-2 mb-6">Repair Quotes Generation</h2>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Create New Quote</h3>
                        <form id="quote-creation-form" class="space-y-3">
                            <input id="quote-client-name" type="text" placeholder="Client Name" required class="w-full p-2 border rounded-lg" />
                            <input id="quote-client-phone" type="tel" placeholder="Client Phone (+CCCXXXX)" required class="w-full p-2 border rounded-lg" />
                            <input id="quote-car-plate" type="text" placeholder="Vehicle Plate" required class="w-full p-2 border rounded-lg" />
                            <input id="quote-car-make" type="text" placeholder="Vehicle Make/Model" class="w-full p-2 border rounded-lg" />

                            <h4 class="font-medium text-gray-700 mt-4">Estimated Items (Parts/Labor)</h4>
                            <div id="quote-items-container" class="space-y-2">
                                </div>
                            <button type="button" onclick="addQuoteItemRow()" class="text-sm text-blue-600 hover:text-blue-800"><i class="fas fa-plus mr-1"></i>Add Quote Item</button>

                            <div class="pt-2 border-t mt-4 flex justify-between items-center">
                                <span class="font-bold">Estimated Total:</span>
                                <span id="quote-total-display" class="font-bold text-xl text-indigo-600">$0.00</span>
                            </div>
                            <button type="submit" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-lg transition duration-150"><i class="fas fa-file-alt mr-2"></i>Generate & Save Quote</button>
                        </form>
                    </div>

                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-lg">
                        <h3 class="text-xl font-semibold mb-4 text-indigo-700 border-b pb-2">Past Repair Quotes</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quote No.</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client / Plate</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount ($)</th>
                                        <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="quotes-table-body" class="bg-white divide-y divide-gray-200">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

        </section>

    </main>
    
   <script src="management.js"></script>
    
    <script>
        // Global function for dynamic rows
        function addInvoiceItemRow() {
            const container = document.getElementById('invoice-items-container');
            const newRow = document.createElement('div');
            // Ensure classes match those used in management.js save/calculate functions
            newRow.className = 'flex space-x-2 invoice-item-row mb-2 items-center';
            newRow.innerHTML = `
                <input type="text" placeholder="Description" class="p-2 border rounded-lg w-1/2 invoice-item-desc" required/>
                <input type="number" placeholder="Qty" class="p-2 border rounded-lg w-1/6 invoice-item-qty" value="1" min="1" required oninput="calculateTotal('invoice')"/>
                <input type="number" placeholder="Unit Price ($)" class="p-2 border rounded-lg w-1/4 invoice-item-unit-price" step="0.01" min="0" required oninput="calculateTotal('invoice')"/>
                <input type="text" placeholder="Total Amount ($)" value="0.00" class="invoice-item-amount form-input w-32 bg-gray-100" readonly>
                <button type="button" onclick="this.parentElement.remove(); calculateTotal('invoice')" class="text-red-500 hover:text-red-700 p-1">
                    <i class="fas fa-trash-alt"></i>
                </button>
            `;
            container.appendChild(newRow);
            calculateTotal('invoice');
        }

        function addQuoteItemRow() {
            const container = document.getElementById('quote-items-container');
            const newRow = document.createElement('div');
            newRow.className = 'flex space-x-2 quote-item-row mb-2 items-center';
            newRow.innerHTML = `
                <input type="text" placeholder="Description" class="p-2 border rounded-lg w-1/2 quote-item-desc" required/>
                <input type="number" placeholder="Qty" class="p-2 border rounded-lg w-1/6 quote-item-qty" value="1" min="1" required oninput="calculateTotal('quote')"/>
                <input type="number" placeholder="Est. Unit Cost ($)" class="p-2 border rounded-lg w-1/4 quote-item-unit-price" step="0.01" min="0" required oninput="calculateTotal('quote')"/>
                <input type="text" placeholder="Total Amount ($)" value="0.00" class="quote-item-amount form-input w-32 bg-gray-100" readonly>
                <button type="button" onclick="this.parentElement.remove(); calculateTotal('quote')" class="text-red-500 hover:text-red-700 p-1">
                    <i class="fas fa-trash-alt"></i>
                </button>
            `;
            container.appendChild(newRow);
            calculateTotal('quote');
        }
        
        // Initial call to add the first item row on page load (since we cleared them in previous step)
        document.addEventListener('DOMContentLoaded', () => {
            // Check if containers exist before attempting to add rows
            if (document.getElementById('invoice-items-container')) {
                addInvoiceItemRow();
            }
            if (document.getElementById('quote-items-container')) {
                addQuoteItemRow();
            }
        });

    </script>

</body>
</html>
